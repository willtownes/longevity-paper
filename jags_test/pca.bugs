#probabilistic PCA
model {
  # Likelihood:
  for( i in 1 : n ) {
    for( j in 1 : d ) {
      y[i,j] ~ dnorm(mu[j]+u[i]%*%v[j], tau_y)
    }
  }
  # Prior:
  for(i in 1:n){
    u[i] ~ dmnorm(0, alpha*Eye_L)
  }
  for(j in 1:d){
    v[j] ~ dmnorm(0, alpha*Eye_L)
    mu[j] ~ dnorm(0, .0001*alpha) #weaker prior for intercept
  }
  tau_y ~ dgamma(.001,.001)
}